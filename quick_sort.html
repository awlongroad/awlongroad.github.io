<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick Sort Interactive Tutorial</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.2em;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            box-shadow: none;
        }

        .array-container {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin: 40px 0;
            flex-wrap: wrap;
            min-height: 80px;
        }

        .array-item {
            width: 70px;
            height: 70px;
            border: 3px solid #764ba2;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            border-radius: 8px;
            transition: all 0.3s ease;
            background: white;
            color: #764ba2;
        }

        .array-item.pivot {
            background: #764ba2;
            color: white;
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(118, 75, 162, 0.5);
        }

        .array-item.left-pointer {
            background: #e8eaf6;
            border-color: #667eea;
            color: #667eea;
        }

        .array-item.right-pointer {
            background: #e8eaf6;
            border-color: #667eea;
            color: #667eea;
        }

        .array-item.swapping {
            background: #ffd54f;
            color: #333;
            animation: swap 0.5s ease;
        }

        .array-item.sorted {
            background: #764ba2;
            color: white;
            opacity: 0.7;
        }

        @keyframes swap {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .explanation {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #764ba2;
        }

        .explanation h3 {
            color: #764ba2;
            margin-bottom: 10px;
        }

        .explanation p {
            line-height: 1.6;
            color: #555;
        }

        .step-counter {
            text-align: center;
            font-size: 1.3em;
            color: #667eea;
            margin: 20px 0;
            font-weight: 600;
        }

        .pointers-info {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .pointer-label {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }

        .pointer-box {
            width: 30px;
            height: 30px;
            border: 3px solid #667eea;
            border-radius: 5px;
            background: #e8eaf6;
        }

        .pointer-box.pivot {
            background: #764ba2;
            border-color: #764ba2;
        }

        .recursion-info {
            background: #e8eaf6;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
            color: #667eea;
            font-weight: 600;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-box {
            width: 40px;
            height: 40px;
            border-radius: 5px;
            border: 3px solid #764ba2;
        }

        .legend-box.pivot {
            background: #764ba2;
        }

        .legend-box.pointer {
            background: #e8eaf6;
            border-color: #667eea;
        }

        .legend-box.swapping {
            background: #ffd54f;
            border-color: #ffd54f;
        }

        .legend-box.sorted {
            background: #764ba2;
            opacity: 0.7;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Quick Sort Algorithm</h1>
        <p class="subtitle">An Interactive Tutorial</p>

        <div class="controls">
            <button id="startBtn">Start Sorting</button>
            <button id="nextBtn" disabled>Next Step</button>
            <button id="resetBtn">Reset</button>
            <button id="autoBtn">Auto Play</button>
        </div>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-box pivot"></div>
                <span>Pivot</span>
            </div>
            <div class="legend-item">
                <div class="legend-box pointer"></div>
                <span>Pointers</span>
            </div>
            <div class="legend-item">
                <div class="legend-box swapping"></div>
                <span>Swapping</span>
            </div>
            <div class="legend-item">
                <div class="legend-box sorted"></div>
                <span>Sorted</span>
            </div>
        </div>

        <div class="step-counter" id="stepCounter">Ready to begin</div>

        <div class="array-container" id="arrayContainer"></div>

        <div class="pointers-info" id="pointersInfo"></div>

        <div class="recursion-info" id="recursionInfo"></div>

        <div class="explanation" id="explanation">
            <h3>How Quick Sort Works</h3>
            <p>
                Quick Sort is a divide-and-conquer algorithm that works by selecting a 'pivot' element 
                and partitioning the array around it. All elements smaller than the pivot go to its left, 
                and all elements greater go to its right. This process is repeated recursively on the 
                sub-arrays until the entire array is sorted.
            </p>
            <br>
            <p><strong>Click "Start Sorting" to begin the demonstration!</strong></p>
        </div>
    </div>

    <script>
        class QuickSortVisualizer {
            constructor() {
                this.originalArray = [7, 29, 15, 36, 24, 20, 18, 30, 12];
                this.array = [...this.originalArray];
                this.steps = [];
                this.currentStep = 0;
                this.isAnimating = false;
                this.autoPlayInterval = null;
                
                this.generateSteps();
                this.render();
                this.attachEventListeners();
            }

            generateSteps() {
                this.steps = [];
                const arr = [...this.originalArray];
                this.quickSort(arr, 0, arr.length - 1, 0);
            }

            quickSort(arr, low, high, depth) {
                if (low < high) {
                    const pi = this.partition(arr, low, high, depth);
                    this.quickSort(arr, low, pi - 1, depth + 1);
                    this.quickSort(arr, pi + 1, high, depth + 1);
                }
            }

            partition(arr, low, high, depth) {
                const pivot = arr[Math.floor((low + high) / 2)];
                const pivotIndex = Math.floor((low + high) / 2);
                
                this.steps.push({
                    array: [...arr],
                    type: 'pivot',
                    pivot: pivotIndex,
                    left: -1,
                    right: -1,
                    description: `Step ${this.steps.length + 1}: Identify the pivot (mid value)`,
                    detail: `We've selected ${pivot} as our pivot element. It's the middle value of the current section.`,
                    depth: depth,
                    range: [low, high]
                });

                let left = low;
                let right = high;

                this.steps.push({
                    array: [...arr],
                    type: 'init-pointers',
                    pivot: pivotIndex,
                    left: left,
                    right: right,
                    description: `Step ${this.steps.length + 1}: Initialise left and right pointers`,
                    detail: `Left pointer starts at index ${left}, right pointer starts at index ${right}.`,
                    depth: depth,
                    range: [low, high]
                });

                while (left <= right) {
                    while (arr[left] < pivot) {
                        left++;
                    }
                    while (arr[right] > pivot) {
                        right--;
                    }

                    if (left <= right) {
                        this.steps.push({
                            array: [...arr],
                            type: 'compare',
                            pivot: pivotIndex,
                            left: left,
                            right: right,
                            description: `Step ${this.steps.length + 1}: Found values to swap`,
                            detail: `${arr[left]} (at index ${left}) > pivot and ${arr[right]} (at index ${right}) < pivot. These need to swap!`,
                            depth: depth,
                            range: [low, high]
                        });

                        [arr[left], arr[right]] = [arr[right], arr[left]];

                        this.steps.push({
                            array: [...arr],
                            type: 'swap',
                            pivot: Math.floor((low + high) / 2),
                            left: left,
                            right: right,
                            swapped: [left, right],
                            description: `Step ${this.steps.length + 1}: Swap the two values`,
                            detail: `Values swapped! Now continue moving the pointers.`,
                            depth: depth,
                            range: [low, high]
                        });

                        left++;
                        right--;
                    }
                }

                this.steps.push({
                    array: [...arr],
                    type: 'partition-complete',
                    pivot: Math.floor((low + high) / 2),
                    left: left,
                    right: right,
                    description: `Step ${this.steps.length + 1}: Partition complete`,
                    detail: `Pivot is in final position. All values left of pivot are smaller, all values right are greater.`,
                    depth: depth,
                    range: [low, high],
                    sortedIndices: [Math.floor((low + high) / 2)]
                });

                return left;
            }

            render() {
                const container = document.getElementById('arrayContainer');
                const step = this.steps[this.currentStep];
                
                if (!step) {
                    container.innerHTML = this.array.map((num, i) => 
                        `<div class="array-item sorted">${num}</div>`
                    ).join('');
                    return;
                }

                container.innerHTML = step.array.map((num, i) => {
                    let classes = ['array-item'];
                    
                    if (i === step.pivot) {
                        classes.push('pivot');
                    } else if (i === step.left) {
                        classes.push('left-pointer');
                    } else if (i === step.right) {
                        classes.push('right-pointer');
                    }
                    
                    if (step.swapped && step.swapped.includes(i)) {
                        classes.push('swapping');
                    }
                    
                    if (step.sortedIndices && step.sortedIndices.includes(i)) {
                        classes.push('sorted');
                    }
                    
                    return `<div class="${classes.join(' ')}">${num}</div>`;
                }).join('');

                this.updateExplanation(step);
                this.updatePointers(step);
                this.updateRecursionInfo(step);
            }

            updateExplanation(step) {
                const explanation = document.getElementById('explanation');
                const stepCounter = document.getElementById('stepCounter');
                
                stepCounter.textContent = step.description;
                
                explanation.innerHTML = `
                    <h3>${step.description}</h3>
                    <p>${step.detail}</p>
                `;
            }

            updatePointers(step) {
                const pointersInfo = document.getElementById('pointersInfo');
                
                if (step.left >= 0 || step.right >= 0) {
                    pointersInfo.innerHTML = `
                        <div class="pointer-label">
                            <div class="pointer-box"></div>
                            <span>Left Pointer: ${step.left >= 0 ? step.array[step.left] : 'N/A'}</span>
                        </div>
                        <div class="pointer-label">
                            <div class="pointer-box pivot"></div>
                            <span>Pivot: ${step.array[step.pivot]}</span>
                        </div>
                        <div class="pointer-label">
                            <div class="pointer-box"></div>
                            <span>Right Pointer: ${step.right >= 0 ? step.array[step.right] : 'N/A'}</span>
                        </div>
                    `;
                } else {
                    pointersInfo.innerHTML = '';
                }
            }

            updateRecursionInfo(step) {
                const recursionInfo = document.getElementById('recursionInfo');
                
                if (step.depth > 0) {
                    const ordinal = ['1st', '2nd', '3rd', '4th', '5th'][Math.min(step.depth - 1, 4)] || `${step.depth}th`;
                    recursionInfo.textContent = `${ordinal} Recursion - Working on sub-array`;
                    recursionInfo.style.display = 'block';
                } else {
                    recursionInfo.style.display = 'none';
                }
            }

            nextStep() {
                if (this.currentStep < this.steps.length - 1) {
                    this.currentStep++;
                    this.render();
                    
                    if (this.currentStep === this.steps.length - 1) {
                        document.getElementById('nextBtn').disabled = true;
                        document.getElementById('stepCounter').textContent = 'Sorting Complete! âœ“';
                        this.stopAutoPlay();
                    }
                }
            }

            start() {
                if (this.steps.length > 0) {
                    this.currentStep = 0;
                    this.render();
                    document.getElementById('nextBtn').disabled = false;
                    document.getElementById('startBtn').disabled = true;
                }
            }

            reset() {
                this.currentStep = 0;
                this.array = [...this.originalArray];
                this.generateSteps();
                this.render();
                document.getElementById('nextBtn').disabled = true;
                document.getElementById('startBtn').disabled = false;
                document.getElementById('stepCounter').textContent = 'Ready to begin';
                this.stopAutoPlay();
                
                const explanation = document.getElementById('explanation');
                explanation.innerHTML = `
                    <h3>How Quick Sort Works</h3>
                    <p>
                        Quick Sort is a divide-and-conquer algorithm that works by selecting a 'pivot' element 
                        and partitioning the array around it. All elements smaller than the pivot go to its left, 
                        and all elements greater go to its right. This process is repeated recursively on the 
                        sub-arrays until the entire array is sorted.
                    </p>
                    <br>
                    <p><strong>Click "Start Sorting" to begin the demonstration!</strong></p>
                `;
            }

            autoPlay() {
                if (this.autoPlayInterval) {
                    this.stopAutoPlay();
                    return;
                }

                if (this.currentStep === 0) {
                    this.start();
                }

                const autoBtn = document.getElementById('autoBtn');
                autoBtn.textContent = 'Stop Auto Play';
                
                this.autoPlayInterval = setInterval(() => {
                    if (this.currentStep < this.steps.length - 1) {
                        this.nextStep();
                    } else {
                        this.stopAutoPlay();
                    }
                }, 1500);
            }

            stopAutoPlay() {
                if (this.autoPlayInterval) {
                    clearInterval(this.autoPlayInterval);
                    this.autoPlayInterval = null;
                    document.getElementById('autoBtn').textContent = 'Auto Play';
                }
            }

            attachEventListeners() {
                document.getElementById('startBtn').addEventListener('click', () => this.start());
                document.getElementById('nextBtn').addEventListener('click', () => this.nextStep());
                document.getElementById('resetBtn').addEventListener('click', () => this.reset());
                document.getElementById('autoBtn').addEventListener('click', () => this.autoPlay());
            }
        }

        const visualizer = new QuickSortVisualizer();
    </script>
</body>
</html>